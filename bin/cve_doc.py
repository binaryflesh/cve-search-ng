#!/usr/bin/env python3
# -*- coding: utf-8 -*-
#
# cve_doc converts CVE to asciidoc
#
# Software is free software released under the "GNU Affero General Public License v3.0"
#
# Copyright (c) 2015-2019  Alexandre Dulaunoy - a@foo.be
# Copyright (c) 2018-2019  Pieter-Jan Moreels - pieter-jan@pidgey.net

# Imports
import json
import os
import re
import sys
runPath = os.path.dirname(os.path.realpath(__file__))
sys.path.append(os.path.join(runPath, ".."))

import json
import re

from optparse import OptionParser

from lib.Query  import Query
from lib.Output import output

optp = OptionParser()
optp.add_option('-c', '--cve', dest='cve', default='CVE-2015-0001', help='CVE id to convert')
optp.add_option('-a', '--api', dest='api', help='HTTP API url (default: http://cve.circl.lu)')
(opts, args) = optp.parse_args()

cve = Query(api=opts.api).cve(opts.cve)
if not cve:
    sys.exit(10)

print(output(cve, "asciidoc"))
